<!DOCTYPE html>
<html>
<head>
    <title>Teste DOM Transcri√ß√£o</title>
    <style>
        #transcriptionText {
            min-height: 150px; 
            font-family: 'Segoe UI', Arial, sans-serif; 
            font-size: 14px; 
            line-height: 1.6; 
            background: #f8f9fa; 
            border: 2px solid #007bff; 
            padding: 12px; 
            white-space: pre-wrap; 
            overflow-y: auto;
            width: 500px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <h1>üß™ Teste Elemento Transcri√ß√£o</h1>
    
    <p><strong>Status:</strong> <span id="status">Carregando...</span></p>
    
    <!-- ELEMENTO ID√äNTICO AO DO TEMPLATE -->
    <div 
        id="transcriptionText" 
        class="form-control" 
        style="min-height: 150px; font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; line-height: 1.6; background: #f8f9fa; border: 2px solid #007bff; padding: 12px; white-space: pre-wrap; overflow-y: auto;">
        Aguardando processamento do √°udio...
    </div>
    
    <br>
    <button onclick="testDirectUpdate()">üß™ Teste Direto</button>
    <button onclick="testApiCall()">üì° Teste API</button>
    <button onclick="clearField()">üßπ Limpar</button>
    
    <script>
        function testDirectUpdate() {
            console.log("üß™ Teste direto do elemento...");
            
            const element = document.getElementById('transcriptionText');
            if (element) {
                element.innerHTML = "‚úÖ TESTE DIRETO FUNCIONOU! Transcri√ß√£o atualizada com sucesso.";
                element.style.background = '#d4edda';
                element.style.borderColor = '#c3e6cb';
                document.getElementById('status').textContent = "‚úÖ Elemento encontrado e atualizado!";
                console.log("‚úÖ Elemento atualizado diretamente!");
            } else {
                console.error("‚ùå Elemento n√£o encontrado!");
                document.getElementById('status').textContent = "‚ùå Elemento N√ÉO encontrado!";
            }
        }
        
        async function testApiCall() {
            console.log("üì° Testando chamada da API...");
            document.getElementById('status').textContent = "üì° Chamando API...";
            
            try {
                const response = await fetch('http://localhost:8000/api/intelligent-medical-analysis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: 'patient_info=Jo√£o Silva 45 pedreiro'
                });
                
                const result = await response.json();
                console.log("üìã Resposta da API:", result);
                
                if (result.success && result.transcription) {
                    const element = document.getElementById('transcriptionText');
                    if (element) {
                        element.innerHTML = result.transcription;
                        element.style.background = '#fff3cd';
                        element.style.borderColor = '#ffeaa7';
                        document.getElementById('status').textContent = "‚úÖ API funcionou! Transcri√ß√£o recebida.";
                        console.log("‚úÖ Transcri√ß√£o da API exibida!");
                    }
                } else {
                    document.getElementById('status').textContent = "‚ùå API n√£o retornou transcri√ß√£o";
                }
            } catch (error) {
                console.error("‚ùå Erro na API:", error);
                document.getElementById('status').textContent = "‚ùå Erro na API: " + error.message;
            }
        }
        
        function clearField() {
            const element = document.getElementById('transcriptionText');
            if (element) {
                element.innerHTML = 'Aguardando processamento do √°udio...';
                element.style.background = '#f8f9fa';
                element.style.borderColor = '#007bff';
                document.getElementById('status').textContent = "Teste limpo";
            }
        }
        
        // Teste autom√°tico ao carregar
        window.onload = function() {
            const element = document.getElementById('transcriptionText');
            if (element) {
                document.getElementById('status').textContent = "‚úÖ Elemento encontrado no DOM";
                console.log("‚úÖ Elemento transcriptionText existe no DOM");
            } else {
                document.getElementById('status').textContent = "‚ùå Elemento N√ÉO encontrado";
                console.error("‚ùå Elemento transcriptionText n√£o existe!");
            }
        };
    </script>
</body>
</html>
